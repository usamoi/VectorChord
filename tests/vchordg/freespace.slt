statement ok
CREATE TABLE t (val vector(3));

statement ok
CREATE INDEX ON t USING vchordg (val vector_l2_ops);

query I
SELECT pg_relation_size('t_val_idx') / current_setting('block_size')::bigint;
----
3

statement ok
INSERT INTO t (val) SELECT ARRAY[random(), random(), random()]::real[] FROM generate_series(1, 18);

query I
SELECT pg_relation_size('t_val_idx') / current_setting('block_size')::bigint;
----
3

statement ok
INSERT INTO t (val) SELECT ARRAY[random(), random(), random()]::real[] FROM generate_series(1, 1);

query I
SELECT pg_relation_size('t_val_idx') / current_setting('block_size')::bigint;
----
4

statement ok
DELETE FROM t;

query I
SELECT pg_relation_size('t_val_idx') / current_setting('block_size')::bigint;
----
4

statement ok
VACUUM (INDEX_CLEANUP ON) t;

query I
SELECT pg_relation_size('t_val_idx') / current_setting('block_size')::bigint;
----
4

statement ok
INSERT INTO t (val) SELECT ARRAY[random(), random(), random()]::real[] FROM generate_series(1, 19);

query I
SELECT pg_relation_size('t_val_idx') / current_setting('block_size')::bigint;
----
4

statement ok
DROP TABLE t;
